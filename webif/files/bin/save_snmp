#!/bin/sh
# SNMP add-on module to webif^2 v1.0
# by Liran Tal <liran@enginx.com>
#
# this module is part of the webif^2 interface for the x-wrt.

snmp_public_name=`nvram show 2>1 | awk -F '=' '/snmp_public_name/ {print $2}`
snmp_public_src=`nvram show 2>1 | awk -F '=' '/snmp_public_src/ {print $2}`
snmp_private_name=`nvram show 2>1 | awk -F '=' '/snmp_private_name/ {print $2}`
snmp_private_src=`nvram show 2>1 | awk -F '=' '/snmp_private_src/ {print $2}`

cat > /etc/snmp/snmpd.conf <<EOF
com2sec  ro  $snmp_public_src    $snmp_public_name
com2sec  rw  $snmp_private_src  $snmp_private_name

group  public   v1   ro
group  public   v2c  ro
group  public   usm  ro
group  private  v1   rw
group  private  v2c  rw
group  private  usm  rw

view  all  included  .1

access  public   ""  any  noauth  exact  all  none  none
access  private  ""  any  noauth  exact  all  all   all
EOF


